{% extends 'home/base.html' %}
{% load static %}
{% block title %} Home {% endblock %}

{% block content %}
<div class="container">
  <h2 class="text-center">Available Lawyers</h2>

  <!-- Category Search -->
  <form method="get" class="mb-4">
<<<<<<< HEAD
    <select name="category" class="form-control w-50 mb-3" onchange="this.form.submit(); toggleOtherCategory()">
      <option value="">-- All Categories --</option>
      <option value="Criminal" {% if selected_category == "Criminal" %}selected{% endif %}>Criminal Lawyer</option>
      <option value="Civil" {% if selected_category == "Civil" %}selected{% endif %}>Civil Lawyer</option>
      <option value="Corporate" {% if selected_category == "Corporate" %}selected{% endif %}>Corporate Lawyer</option>
      <option value="Other" {% if selected_category == "Other" %}selected{% endif %}>Other</option>
    </select>

=======
    <select name="category" class="form-control w-50 mb-3" onchange="this.form.submit()">
      <option value="">-- All Categories --</option>
      <option value="criminal" {% if selected_category == "criminal" %}selected{% endif %}>Criminal Lawyer</option>
      <option value="civil" {% if selected_category == "civil" %}selected{% endif %}>Civil Lawyer</option>
      <option value="corporate" {% if selected_category == "corporate" %}selected{% endif %}>Corporate Lawyer</option>
      <option value="other" {% if selected_category == "other" %}selected{% endif %}>Other</option>
    </select>
>>>>>>> 8c18ded32e8fc8b4a9705899026da72319422024
  </form>

  <!-- Lawyer Cards -->
  <div class="row">
    {% for lawyer in lawyers %}
    <div class="col-md-4 mb-4">
      <div class="card p-3 h-100">
        <img src="{{ lawyer.photo.url }}" alt="Lawyer Photo" class="card-img-top" style="height:250px; object-fit:cover;">
        <div class="card-body">
          <h5 class="card-title">{{ lawyer.first_name }} {{ lawyer.last_name }}</h5>
          <p>Email: {{ lawyer.email }}</p>
          <p>Phone: {{ lawyer.phone }}</p>
          <p>License No: {{ lawyer.license_number }}</p>
          <p>Category: {{ lawyer.category }}</p>

          <!-- Book Now Button -->
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#bookModal{{ lawyer.id }}">
            Book Now
          </button>
        </div>
      </div>
    </div>

    <!-- Modal for Booking -->
    <div class="modal fade" id="bookModal{{ lawyer.id }}" tabindex="-1" role="dialog" aria-labelledby="bookModalLabel{{ lawyer.id }}" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <form action="{% url 'client:book_appointment' lawyer.id.id %}" method="post">
          {% csrf_token %}
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="bookModalLabel{{ lawyer.id }}">Book Appointment</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span>&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Issue</label>
                <textarea class="form-control" name="issue" required></textarea>
              </div>
              <div class="form-group">
                <label>Date</label>
                <input type="date" class="form-control" name="appointment_date" required min="{{ today }}">
              </div>
              <div class="form-group">
                <label>Time</label>
                <select name="appointment_time" class="form-control" required>
                  <option value="">Select time slot</option>
                  <option value="09:00">09:00 AM - 10:00 AM</option>
                  <option value="10:00">10:00 AM - 11:00 AM</option>
                  <option value="11:00">11:00 AM - 12:00 PM</option>
                  <option value="12:00">12:00 PM - 01:00 PM</option>
                  <option value="14:00">02:00 PM - 03:00 PM</option>
                  <option value="15:00">03:00 PM - 04:00 PM</option>
                  <option value="16:00">04:00 PM - 05:00 PM</option>
                </select>
              </div>
              <div class="form-group">
                <label>Mode</label>
                <select name="appointment_mode" class="form-control" required>
                  <option value="online">Online</option>
                  <option value="offline">Offline</option>
                </select>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-success">Submit</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    {% empty %}
      <div class="col-12">
        <p class="text-center">No lawyers found for this category.</p>
      </div>
    {% endfor %}
  </div>

  <!-- Flash Messages -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert" style="position: fixed; top: 10px; right: 10px; z-index: 9999; width: auto;">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" style="border: none; background: none;">
          <i class="bi bi-x-lg" style="font-size: 1.2rem;"></i>
        </button>
      </div>
    {% endfor %}
  {% endif %}
</div>
<<<<<<< HEAD

<script>
  // Function to show or hide the input box when "Other" is selected
  function toggleOtherCategory() {
    var categorySelect = document.querySelector('select[name="category"]');
    var otherCategoryInput = document.getElementById('otherCategoryInput');
    
    // Show the input box if "Other" is selected, else hide it
    if (categorySelect.value === "Other") {
      otherCategoryInput.style.display = "block";
    } else {
      otherCategoryInput.style.display = "none";
    }
  }

  // Trigger the function on page load to handle the selected category
  window.onload = function() {
    toggleOtherCategory();
  };
</script>

=======
>>>>>>> 8c18ded32e8fc8b4a9705899026da72319422024
{% endblock %}
